public void setAggBuilder(AggregatorFactories.Builder aggBuilder) {for (AggregationBuilder aggregation : aggBuilder.getAggregatorFactories()) {final String type = aggregation.getType(); switch (type)  {case MinAggregationBuilder.NAME: case MaxAggregationBuilder.NAME: case AvgAggregationBuilder.NAME: case SumAggregationBuilder.NAME: case CardinalityAggregationBuilder.NAME: break; default: // top term and percentile should be supported throw new IllegalArgumentException("Unsupported aggregation of type [" + type + "]"); } } for (PipelineAggregationBuilder aggregation : aggBuilder.getPipelineAggregatorFactories()) { // should not have pipeline aggregations final String type = aggregation.getType(); throw new IllegalArgumentException("Unsupported pipeline aggregation of type [" + type + "]");} this.aggBuilder = aggBuilder;}